<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8" />
    <title>Bot Enhanced - Hidden Prechat Fixos</title>

    <style type="text/css">
        body {
            font-family: "Salesforce Sans", Arial, sans-serif;
            margin: 20px;
        }

        h2 {
            color: #EB640A;
        }

        .status {
            margin-top: 12px;
            font-size: 0.9rem;
            color: #555;
        }

        /* Launcher igual ao Standard */
        .embeddedServiceHelpButton .helpButton .uiButton {
            background-color: #EB640A;
            font-family: "Salesforce Sans", sans-serif;
        }
        .embeddedServiceHelpButton .helpButton .uiButton:focus {
            outline: 1px solid #EB640A;
        }

        @font-face {
            font-family: "Salesforce Sans";
            src: url("https://c1.sfdcstatic.com/etc/clientlibs/sfdc-aem-master/clientlibs_base/fonts/SalesforceSans-Regular.woff") format("woff"),
                 url("https://c1.sfdcstatic.com/etc/clientlibs/sfdc-aem-master/clientlibs_base/fonts/SalesforceSans-Regular.ttf") format("truetype");
        }
    </style>
</head>
<body>
    <h2>Teste do Bras Enhanced (AccountId / ContactId fixos)</h2>

    <p>
        Esta página seta automaticamente <code>AccountId</code> e <code>ContactId</code> como
        <em>Hidden Pre-Chat Fields</em> assim que o Embedded Messaging estiver pronto.
        Basta clicar no botão do chat no rodapé.
    </p>

    <div class="status" id="statusMessage">
        Carregando script do Salesforce...
    </div>

    <script type="text/javascript">
        window.addEventListener("onEmbeddedMessagingReady", () => {
            document.getElementById("statusMessage").textContent =
                "Embedded Messaging carregado. Pode clicar no botão do chat.";

            const hiddenFields = {
                AccountId: {
                    value: "0018900000WyW8PAAV",
                    isEditableByEndUser: false
                },
                ContactId: {
                    value: "0038900000OCz1uAAD",
                    isEditableByEndUser: false
                }
            };

            try {
                embeddedservice_bootstrap.prechatAPI.setHiddenPrechatFields(hiddenFields);
                console.log("Hidden pre-chat fields definidos:", hiddenFields);
            } catch (e) {
                console.error("Erro ao definir hidden pre-chat fields:", e);
                document.getElementById("statusMessage").textContent =
                    "Erro ao definir hidden pre-chat fields. Veja o console.";
            }
        });

        function initEmbeddedMessaging() {
            try {
                embeddedservice_bootstrap.settings.language = "pt_BR";

                embeddedservice_bootstrap.init(
                    "00D890000032JqX", // Org Id (sandbox)
                    "Bras_CanaisDigitaisEnhanced", // Dev name do deployment
                    "https://supergasbras--tecnica25.sandbox.my.site.com/ESWBrasCanaisDigitais1764590606132",
                    {
                        scrt2URL: "https://supergasbras--tecnica25.sandbox.my.salesforce-scrt.com"
                    }
                );
            } catch (err) {
                console.error("Error loading Embedded Messaging: ", err);
                document.getElementById("statusMessage").textContent =
                    "Erro ao carregar Embedded Messaging. Veja o console.";
            }
        }
    </script>

    <script
        type="text/javascript"
        src="https://supergasbras--tecnica25.sandbox.my.site.com/ESWBrasCanaisDigitais1764590606132/assets/js/bootstrap.min.js"
        onload="initEmbeddedMessaging()">
    </script>
</body>
</html>
